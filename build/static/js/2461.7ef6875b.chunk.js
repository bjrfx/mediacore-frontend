"use strict";(self.webpackChunkmediacore_frontend=self.webpackChunkmediacore_frontend||[]).push([[2461],{2461:(e,t,a)=>{a.d(t,{Y$:()=>k,Nr:()=>C,lD:()=>c,Px:()=>I,Vd:()=>h,dS:()=>K,t3:()=>W,IB:()=>d});var n=a(65043),r=a(81228),s=a(96938),o=a(99766),l=a(70579);const i=[{min:0,max:20,label:"Very Unpleasant",color:"from-red-500 to-red-600",emoji:"\ud83d\ude22"},{min:20,max:40,label:"Unpleasant",color:"from-orange-400 to-orange-500",emoji:"\ud83d\ude15"},{min:40,max:60,label:"Neutral",color:"from-yellow-400 to-yellow-500",emoji:"\ud83d\ude10"},{min:60,max:80,label:"Pleasant",color:"from-lime-400 to-green-500",emoji:"\ud83d\ude42"},{min:80,max:100,label:"Very Pleasant",color:"from-green-400 to-emerald-500",emoji:"\ud83d\ude0a"}],c=[{name:"Happy",emoji:"\ud83d\ude0a",category:"positive"},{name:"Grateful",emoji:"\ud83d\ude4f",category:"positive"},{name:"Excited",emoji:"\ud83c\udf89",category:"positive"},{name:"Calm",emoji:"\ud83d\ude0c",category:"positive"},{name:"Proud",emoji:"\ud83d\udcaa",category:"positive"},{name:"Hopeful",emoji:"\u2728",category:"positive"},{name:"Loved",emoji:"\u2764\ufe0f",category:"positive"},{name:"Inspired",emoji:"\ud83d\udca1",category:"positive"},{name:"Thoughtful",emoji:"\ud83e\udd14",category:"neutral"},{name:"Curious",emoji:"\ud83e\uddd0",category:"neutral"},{name:"Surprised",emoji:"\ud83d\ude2e",category:"neutral"},{name:"Nostalgic",emoji:"\ud83d\udcad",category:"neutral"},{name:"Anxious",emoji:"\ud83d\ude30",category:"negative"},{name:"Sad",emoji:"\ud83d\ude22",category:"negative"},{name:"Frustrated",emoji:"\ud83d\ude24",category:"negative"},{name:"Tired",emoji:"\ud83d\ude34",category:"negative"},{name:"Stressed",emoji:"\ud83d\ude2b",category:"negative"},{name:"Lonely",emoji:"\ud83e\udd7a",category:"negative"}],d=e=>i.find(t=>e>=t.min&&e<=t.max)||i[2],u=e=>{let{value:t,onChange:a}=e;const s=d(t),[i,c]=(0,n.useState)(!1);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(r.P.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},className:"text-6xl mb-2",children:s.emoji},s.emoji),(0,l.jsx)(r.P.p,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},className:(0,o.cn)("text-lg font-medium bg-gradient-to-r bg-clip-text text-transparent",s.color),children:s.label},s.label)]}),(0,l.jsxs)("div",{className:"relative px-2 py-4",children:[(0,l.jsx)("div",{className:"absolute inset-x-2 top-1/2 -translate-y-1/2 h-2 rounded-full bg-gradient-to-r from-red-500 via-yellow-400 to-green-500 opacity-30"}),(0,l.jsx)(r.P.div,{className:(0,o.cn)("absolute left-2 top-1/2 -translate-y-1/2 h-2 rounded-full bg-gradient-to-r",s.color),style:{width:"".concat(t,"%")},animate:{width:"".concat(t,"%")},transition:{type:"spring",stiffness:300,damping:30}}),(0,l.jsx)("input",{type:"range",min:"0",max:"100",value:t,onChange:e=>a(parseInt(e.target.value)),onMouseDown:()=>c(!0),onMouseUp:()=>c(!1),onTouchStart:()=>c(!0),onTouchEnd:()=>c(!1),className:"relative w-full h-8 appearance-none bg-transparent cursor-pointer z-10 [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-6 [&::-webkit-slider-thumb]:h-6 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:shadow-lg [&::-webkit-slider-thumb]:shadow-black/20 [&::-webkit-slider-thumb]:cursor-grab [&::-webkit-slider-thumb]:active:cursor-grabbing [&::-webkit-slider-thumb]:transition-transform [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-6 [&::-moz-range-thumb]:h-6 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-white [&::-moz-range-thumb]:border-0 [&::-moz-range-thumb]:shadow-lg [&::-moz-range-thumb]:cursor-grab "}),(0,l.jsx)(r.P.div,{className:(0,o.cn)("absolute top-1/2 -translate-y-1/2 w-10 h-10 rounded-full blur-md opacity-50 pointer-events-none bg-gradient-to-r",s.color),style:{left:"calc(".concat(t,"% - 20px + 8px)")},animate:{scale:i?1.5:1,opacity:i?.7:.5}})]}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground px-2",children:[(0,l.jsx)("span",{children:"Very Unpleasant"}),(0,l.jsx)("span",{children:"Very Pleasant"})]})]})},m=e=>{let{emotion:t,isSelected:a,onToggle:n}=e;return(0,l.jsxs)(r.P.button,{type:"button",onClick:()=>n(t.name),whileHover:{scale:1.05},whileTap:{scale:.95},className:(0,o.cn)("flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-200",a?"bg-primary text-primary-foreground shadow-lg shadow-primary/25":"bg-secondary/50 text-muted-foreground hover:bg-secondary hover:text-foreground"),children:[(0,l.jsx)("span",{className:"text-base",children:t.emoji}),(0,l.jsx)("span",{children:t.name}),a&&(0,l.jsx)(r.P.span,{initial:{scale:0},animate:{scale:1},className:"w-1.5 h-1.5 rounded-full bg-primary-foreground"})]})};function h(e){var t,a;let{mood:o,onChange:i,compact:h=!1}=e;const[x,p]=(0,n.useState)(null!==(t=null===o||void 0===o?void 0:o.value)&&void 0!==t?t:50),[g,f]=(0,n.useState)(null!==(a=null===o||void 0===o?void 0:o.emotions)&&void 0!==a?a:[]),[y,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{var e,t;o&&(p(null!==(e=o.value)&&void 0!==e?e:50),f(null!==(t=o.emotions)&&void 0!==t?t:[]))},[o]);const b=(0,n.useCallback)((e,t)=>{null===i||void 0===i||i({value:e,emotions:t})},[i]),j=e=>{const t=g.includes(e)?g.filter(t=>t!==e):[...g,e];f(t),b(x,t)},w=y?c:x>=60?c.filter(e=>"positive"===e.category):x<=40?c.filter(e=>"negative"===e.category):c.filter(e=>"neutral"===e.category);if(h){const e=d(x);return(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"text-2xl",children:e.emoji}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-1",children:[g.slice(0,3).map(e=>{const t=c.find(t=>t.name===e);return t?(0,l.jsxs)("span",{className:"text-xs bg-secondary px-2 py-0.5 rounded-full",children:[t.emoji," ",t.name]},e):null}),g.length>3&&(0,l.jsxs)("span",{className:"text-xs text-muted-foreground",children:["+",g.length-3]})]})]})}return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-1",children:"How are you feeling?"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Move the slider and select emotions that describe your mood"})]}),(0,l.jsx)(u,{value:x,onChange:e=>{p(e),b(e,g)}}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:y?"All Emotions":"Suggested Emotions"}),(0,l.jsx)("button",{type:"button",onClick:()=>v(!y),className:"text-xs text-primary hover:underline",children:y?"Show Suggested":"Show All"})]}),(0,l.jsx)(r.P.div,{layout:!0,className:"flex flex-wrap gap-2",children:(0,l.jsx)(s.N,{mode:"popLayout",children:w.map(e=>(0,l.jsx)(r.P.div,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:(0,l.jsx)(m,{emotion:e,isSelected:g.includes(e.name),onToggle:j})},e.name))})})]}),g.length>0&&(0,l.jsxs)(r.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 rounded-lg bg-secondary/30 text-sm text-muted-foreground",children:[(0,l.jsx)("span",{className:"font-medium text-foreground",children:"Selected: "}),g.join(", ")]})]})}var x=a(10629),p=a(64830),g=a(19340),f=a(84991),y=a(9855),v=a(36210),b=a(13390);const j=e=>{const t=Math.floor(e/60),a=Math.floor(e%60);return"".concat(t,":").concat(a.toString().padStart(2,"0"))},w=e=>{let{isRecording:t,audioData:a}=e;return(0,l.jsx)("div",{className:"flex items-center justify-center gap-1 h-16",children:Array.from({length:20}).map((e,n)=>{const s=t?(null===a||void 0===a?void 0:a[n])||100*Math.random():20;return(0,l.jsx)(r.P.div,{className:(0,o.cn)("w-1 rounded-full transition-colors",t?"bg-red-500":"bg-muted-foreground/30"),animate:{height:"".concat(Math.max(8,.6*s),"px")},transition:{duration:.1,ease:"easeOut"}},n)})})},N=e=>{let{audioUrl:t,currentTime:a,duration:s,isPlaying:i}=e;const[c,d]=(0,n.useState)([]);(0,n.useRef)(null);(0,n.useEffect)(()=>{const e=Array.from({length:50},()=>.8*Math.random()+.2);d(e)},[t]);const u=s>0?a/s:0;return(0,l.jsx)("div",{className:"relative h-12 w-full flex items-center gap-0.5",children:c.map((e,t)=>{const a=t/c.length<=u;return(0,l.jsx)(r.P.div,{className:(0,o.cn)("flex-1 rounded-full transition-colors duration-150",a?"bg-primary":"bg-muted-foreground/30"),style:{height:"".concat(100*e,"%")},initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.01*t}},t)})})};function C(e){let{onSave:t,onCancel:a,existingAudio:i}=e;const[c,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),[h,C]=(0,n.useState)(0),[k,A]=(0,n.useState)(null),[P,S]=(0,n.useState)((null===i||void 0===i?void 0:i.url)||null),[T,L]=(0,n.useState)(!1),[R,H]=(0,n.useState)(0),[E,U]=(0,n.useState)((null===i||void 0===i?void 0:i.duration)||0),[F,q]=(0,n.useState)([]),I=(0,n.useRef)(null),M=(0,n.useRef)([]),D=(0,n.useRef)(null),z=(0,n.useRef)(null),B=(0,n.useRef)(null),O=(0,n.useRef)(null);(0,n.useEffect)(()=>()=>{z.current&&clearInterval(z.current),O.current&&cancelAnimationFrame(O.current),P&&!i&&URL.revokeObjectURL(P)},[P,i]);const $=(0,n.useCallback)(e=>{const t=new(window.AudioContext||window.webkitAudioContext),a=t.createAnalyser(),n=t.createMediaStreamSource(e);a.fftSize=64,n.connect(a),B.current=a;const r=()=>{if(!c)return;const e=new Uint8Array(a.frequencyBinCount);a.getByteFrequencyData(e),q(Array.from(e)),O.current=requestAnimationFrame(r)};r()},[c]),V=()=>{D.current&&(D.current.pause(),D.current=null),P&&!i&&URL.revokeObjectURL(P),S(null),A(null),H(0),U(0),L(!1),C(0)};return(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsx)(s.N,{mode:"wait",children:P?(0,l.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[(0,l.jsxs)("div",{className:"p-4 rounded-xl bg-secondary/30",children:[(0,l.jsx)(N,{audioUrl:P,currentTime:R,duration:E,isPlaying:T}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground mt-2",children:[(0,l.jsx)("span",{children:j(R)}),(0,l.jsx)("span",{children:j(E)})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,l.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:V,className:"w-10 h-10 rounded-full bg-secondary flex items-center justify-center hover:bg-destructive hover:text-destructive-foreground transition-colors",children:(0,l.jsx)(y.A,{className:"w-4 h-4"})}),(0,l.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{D.current||(D.current=new Audio(P),D.current.ontimeupdate=()=>{H(D.current.currentTime)},D.current.onended=()=>{L(!1),H(0)}),T?D.current.pause():D.current.play(),L(!T)},className:"w-14 h-14 rounded-full bg-primary flex items-center justify-center shadow-lg shadow-primary/30 hover:bg-primary/90 transition-colors",children:T?(0,l.jsx)(g.A,{className:"w-6 h-6 text-primary-foreground"}):(0,l.jsx)(p.A,{className:"w-6 h-6 text-primary-foreground ml-0.5"})}),(0,l.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{k&&(null===t||void 0===t||t(k,E))},className:"w-10 h-10 rounded-full bg-primary flex items-center justify-center hover:bg-primary/90 transition-colors",children:(0,l.jsx)(v.A,{className:"w-4 h-4 text-primary-foreground"})})]}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,l.jsx)(b.$,{variant:"ghost",size:"sm",onClick:V,children:"Re-record"}),(0,l.jsx)(b.$,{variant:"ghost",size:"sm",onClick:a,children:"Cancel"})]})]},"playback"):(0,l.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[(0,l.jsx)(w,{isRecording:c,audioData:F}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(r.P.span,{className:(0,o.cn)("text-3xl font-mono font-medium",c&&"text-red-500"),animate:{opacity:c&&!u?[1,.5]:1},transition:{duration:.5,repeat:c&&!u?1/0:0,repeatType:"reverse"},children:j(h)}),c&&(0,l.jsx)(r.P.p,{initial:{opacity:0},animate:{opacity:1},className:"text-sm text-muted-foreground mt-1",children:u?"Paused":"Recording..."})]}),(0,l.jsx)("div",{className:"flex items-center justify-center gap-4",children:c?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{I.current&&c&&(u?(I.current.resume(),z.current=setInterval(()=>{C(e=>e+1)},1e3)):(I.current.pause(),clearInterval(z.current)),m(!u))},className:"w-12 h-12 rounded-full bg-secondary flex items-center justify-center hover:bg-secondary/80 transition-colors",children:u?(0,l.jsx)(p.A,{className:"w-5 h-5 ml-0.5"}):(0,l.jsx)(g.A,{className:"w-5 h-5"})}),(0,l.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{I.current&&c&&(I.current.stop(),clearInterval(z.current),O.current&&cancelAnimationFrame(O.current),d(!1),m(!1))},className:"w-16 h-16 rounded-full bg-red-500 flex items-center justify-center shadow-lg shadow-red-500/30 hover:bg-red-600 transition-colors",children:(0,l.jsx)(f.A,{className:"w-6 h-6 text-white fill-white"})})]}):(0,l.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});I.current=new MediaRecorder(e),M.current=[],I.current.ondataavailable=e=>{M.current.push(e.data)},I.current.onstop=()=>{const t=new Blob(M.current,{type:"audio/webm"});A(t);const a=URL.createObjectURL(t);S(a);const n=new Audio(a);n.onloadedmetadata=()=>{U(n.duration)},e.getTracks().forEach(e=>e.stop())},I.current.start(),d(!0),m(!1),C(0),z.current=setInterval(()=>{C(e=>e+1)},1e3),$(e)}catch(e){console.error("Error accessing microphone:",e),alert("Could not access microphone. Please check permissions.")}},className:"w-16 h-16 rounded-full bg-red-500 flex items-center justify-center shadow-lg shadow-red-500/30 hover:bg-red-600 transition-colors",children:(0,l.jsx)(x.A,{className:"w-7 h-7 text-white"})})}),(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)(b.$,{variant:"ghost",onClick:a,className:"text-muted-foreground",children:"Cancel"})})]},"recording")})})}function k(e){let{audioUrl:t,duration:a,name:s}=e;const o=(0,n.useRef)(null),[i,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(0);(0,n.useEffect)(()=>()=>{o.current&&o.current.pause()},[]);const m=a>0?d/a*100:0;return(0,l.jsxs)(r.P.div,{whileHover:{scale:1.02},className:"flex items-center gap-3 p-3 rounded-xl bg-secondary/50 cursor-pointer",onClick:()=>{o.current||(o.current=new Audio(t),o.current.ontimeupdate=()=>{u(o.current.currentTime)},o.current.onended=()=>{c(!1),u(0)}),i?o.current.pause():o.current.play(),c(!i)},children:[(0,l.jsx)("button",{className:"w-10 h-10 rounded-full bg-primary flex items-center justify-center shrink-0",children:i?(0,l.jsx)(g.A,{className:"w-4 h-4 text-primary-foreground"}):(0,l.jsx)(p.A,{className:"w-4 h-4 text-primary-foreground ml-0.5"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"text-sm font-medium truncate",children:s||"Voice Recording"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"flex-1 h-1 rounded-full bg-muted overflow-hidden",children:(0,l.jsx)(r.P.div,{className:"h-full bg-primary",style:{width:"".concat(m,"%")}})}),(0,l.jsxs)("span",{className:"text-xs text-muted-foreground shrink-0",children:[j(d)," / ",j(a)]})]})]})]})}var A=a(40614),P=a(36360),S=a(91940),T=a(82706),L=a(28006),R=a(70067),H=a(247),E=a(65598);const U=e=>{let{src:t,onRemove:a,index:n}=e;return(0,l.jsxs)(r.P.div,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"relative aspect-square rounded-xl overflow-hidden group",children:[(0,l.jsx)("img",{src:t,alt:"Attachment ".concat(n+1),className:"w-full h-full object-cover"}),(0,l.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,l.jsx)(r.P.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:a,className:"w-8 h-8 rounded-full bg-destructive flex items-center justify-center",children:(0,l.jsx)(A.A,{className:"w-4 h-4 text-white"})})})]})},F=e=>{let{onCapture:t,onClose:a}=e;const s=(0,n.useRef)(null),[o,i]=(0,n.useState)(null),[c,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)(null),h=(0,n.useCallback)(async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});i(e),s.current&&(s.current.srcObject=e,s.current.onloadedmetadata=()=>{d(!0)})}catch(e){console.error("Error accessing camera:",e),alert("Could not access camera. Please check permissions."),a()}},[a]),x=(0,n.useCallback)(()=>{o&&(o.getTracks().forEach(e=>e.stop()),i(null))},[o]);n.useEffect(()=>(h(),()=>x()),[]);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"relative aspect-[4/3] rounded-xl overflow-hidden bg-black",children:u?(0,l.jsx)("img",{src:u.url,alt:"Captured",className:"w-full h-full object-cover"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),!c&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,l.jsx)(P.A,{className:"w-8 h-8 animate-spin text-white"})})]})}),(0,l.jsx)("div",{className:"flex items-center justify-center gap-4",children:u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.$,{variant:"outline",onClick:()=>{u&&(URL.revokeObjectURL(u.url),m(null))},children:"Retake"}),(0,l.jsxs)(b.$,{onClick:()=>{u&&(t(u.blob),x(),a())},children:[(0,l.jsx)(S.A,{className:"w-4 h-4 mr-2"}),"Use Photo"]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.$,{variant:"outline",onClick:a,children:"Cancel"}),(0,l.jsx)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{if(s.current&&c){const e=document.createElement("canvas");e.width=s.current.videoWidth,e.height=s.current.videoHeight;e.getContext("2d").drawImage(s.current,0,0),e.toBlob(e=>{const t=URL.createObjectURL(e);m({blob:e,url:t})},"image/jpeg",.9)}},disabled:!c,className:"w-16 h-16 rounded-full bg-white border-4 border-primary flex items-center justify-center disabled:opacity-50",children:(0,l.jsx)("div",{className:"w-12 h-12 rounded-full bg-primary"})})]})})]})},q=e=>{let{location:t,onChange:a,onClose:s}=e;const[o,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(t);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(r.P.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:async()=>{i(!0);try{var e;const t=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:1e4})}),{latitude:a,longitude:n}=t.coords,r=await fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(a,"&lon=").concat(n)),s=await r.json(),o={name:(null===(e=s.display_name)||void 0===e?void 0:e.split(",").slice(0,3).join(","))||"Current Location",lat:a,lng:n,fullAddress:s.display_name};m(o)}catch(t){console.error("Error getting location:",t),alert("Could not get your location. Please check permissions.")}finally{i(!1)}},disabled:o,className:"w-full flex items-center gap-3 p-4 rounded-xl bg-primary/10 hover:bg-primary/20 transition-colors text-left",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center",children:o?(0,l.jsx)(P.A,{className:"w-5 h-5 animate-spin text-primary"}):(0,l.jsx)(T.A,{className:"w-5 h-5 text-primary"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"Use Current Location"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Automatically detect your location"})]})]}),u&&(0,l.jsx)(r.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-xl bg-secondary/50 space-y-2",children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)(L.A,{className:"w-5 h-5 text-primary shrink-0 mt-0.5"}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("p",{className:"font-medium",children:u.name}),u.fullAddress&&(0,l.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:u.fullAddress})]})]})}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2 pt-2",children:[u&&(0,l.jsx)(b.$,{variant:"ghost",onClick:()=>{m(null),a(null),s()},children:"Remove Location"}),(0,l.jsx)(b.$,{variant:"outline",onClick:s,children:"Cancel"}),(0,l.jsx)(b.$,{onClick:()=>{a(u),s()},disabled:!u,children:"Save Location"})]})]})};function I(e){let{images:t=[],location:a,onAddImage:i,onRemoveImage:c,onLocationChange:d,maxImages:u=10}=e;const m=(0,n.useRef)(null),[h,x]=(0,n.useState)(!1),[p,g]=(0,n.useState)(!1);return(0,l.jsxs)("div",{className:"space-y-4",children:[t.length>0&&(0,l.jsx)(r.P.div,{layout:!0,className:"grid grid-cols-3 gap-2",children:(0,l.jsx)(s.N,{mode:"popLayout",children:t.map((e,t)=>(0,l.jsx)(U,{src:e.url,index:t,onRemove:()=>null===c||void 0===c?void 0:c(e.id)},e.id))})}),a&&(0,l.jsxs)(r.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-sm",children:[(0,l.jsx)(L.A,{className:"w-4 h-4 text-primary"}),(0,l.jsx)("span",{className:"text-muted-foreground truncate",children:a.name}),(0,l.jsx)("button",{onClick:()=>null===d||void 0===d?void 0:d(null),className:"text-muted-foreground hover:text-foreground",children:(0,l.jsx)(A.A,{className:"w-3 h-3"})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,l.jsx)("input",{ref:m,type:"file",accept:"image/*",multiple:!0,onChange:async e=>{const a=Array.from(e.target.files);for(const n of a){if(t.length>=u)break;n.type.startsWith("image/")&&(null===i||void 0===i||i(n))}m.current&&(m.current.value="")},className:"hidden"}),(0,l.jsxs)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.click()},disabled:t.length>=u,className:(0,o.cn)("flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-colors","bg-secondary/50 hover:bg-secondary text-muted-foreground hover:text-foreground","disabled:opacity-50 disabled:cursor-not-allowed"),children:[(0,l.jsx)(R.A,{className:"w-4 h-4"}),"Add Photo"]}),(0,l.jsxs)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>x(!0),disabled:t.length>=u,className:(0,o.cn)("flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-colors","bg-secondary/50 hover:bg-secondary text-muted-foreground hover:text-foreground","disabled:opacity-50 disabled:cursor-not-allowed"),children:[(0,l.jsx)(H.A,{className:"w-4 h-4"}),"Camera"]}),(0,l.jsxs)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>g(!0),className:(0,o.cn)("flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-colors",a?"bg-primary/10 text-primary hover:bg-primary/20":"bg-secondary/50 hover:bg-secondary text-muted-foreground hover:text-foreground"),children:[(0,l.jsx)(L.A,{className:"w-4 h-4"}),a?"Edit Location":"Add Location"]})]}),(0,l.jsx)(E.lG,{open:h,onOpenChange:x,children:(0,l.jsxs)(E.Cf,{className:"sm:max-w-lg",children:[(0,l.jsx)(E.c7,{children:(0,l.jsx)(E.L3,{children:"Take a Photo"})}),(0,l.jsx)(F,{onCapture:e=>{const t=new File([e],"photo_".concat(Date.now(),".jpg"),{type:"image/jpeg"});null===i||void 0===i||i(t)},onClose:()=>x(!1)})]})}),(0,l.jsx)(E.lG,{open:p,onOpenChange:g,children:(0,l.jsxs)(E.Cf,{className:"sm:max-w-md",children:[(0,l.jsx)(E.c7,{children:(0,l.jsx)(E.L3,{children:"Add Location"})}),(0,l.jsx)(q,{location:a,onChange:d,onClose:()=>g(!1)})]})})]})}var M=a(1367),D=a(73728),z=a(15146),B=a(8759),O=a(2284),$=a(75375),V=a(978);const _=e=>{let{icon:t,isActive:a,onClick:n,title:s}=e;return(0,l.jsx)(r.P.button,{type:"button",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:n,title:s,className:(0,o.cn)("w-8 h-8 rounded-lg flex items-center justify-center transition-colors",a?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-secondary"),children:(0,l.jsx)(t,{className:"w-4 h-4"})})},G=e=>{let{onFormat:t,activeFormats:a}=e;const s=[{icon:M.A,command:"bold",title:"Bold (Ctrl+B)"},{icon:D.A,command:"italic",title:"Italic (Ctrl+I)"},{icon:z.A,command:"h1",title:"Heading 1"},{icon:B.A,command:"h2",title:"Heading 2"},{icon:O.A,command:"ul",title:"Bullet List"},{icon:$.A,command:"ol",title:"Numbered List"},{icon:V.A,command:"blockquote",title:"Quote"}];return(0,l.jsx)(r.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-1 p-1 rounded-xl bg-secondary/50 backdrop-blur-sm",children:s.map((e,r)=>(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(_,{icon:e.icon,isActive:a.includes(e.command),onClick:()=>t(e.command),title:e.title}),1===r&&(0,l.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),3===r&&(0,l.jsx)("div",{className:"w-px h-6 bg-border mx-1"})]},e.command))})};function K(e){let{content:t="",placeholder:a="Start writing...",onChange:s,onPlainTextChange:i,autoFocus:c=!1,showToolbar:d=!0,minHeight:u="200px"}=e;const m=(0,n.useRef)(null),[h,x]=(0,n.useState)([]),[p,g]=(0,n.useState)(!1),[f,y]=(0,n.useState)(!t);(0,n.useEffect)(()=>{m.current&&t&&m.current.innerHTML!==t&&(m.current.innerHTML=t,y(!t||"<br>"===t||"<p><br></p>"===t))},[t]),(0,n.useEffect)(()=>{c&&m.current&&m.current.focus()},[c]);const v=(0,n.useCallback)(()=>{const e=[];document.queryCommandState("bold")&&e.push("bold"),document.queryCommandState("italic")&&e.push("italic");const t=window.getSelection();if(t.rangeCount>0){const a=t.getRangeAt(0).commonAncestorContainer,n=3===a.nodeType?a.parentElement:a;null!==n&&void 0!==n&&n.closest("h1")&&e.push("h1"),null!==n&&void 0!==n&&n.closest("h2")&&e.push("h2"),null!==n&&void 0!==n&&n.closest("ul")&&e.push("ul"),null!==n&&void 0!==n&&n.closest("ol")&&e.push("ol"),null!==n&&void 0!==n&&n.closest("blockquote")&&e.push("blockquote")}x(e)},[]),b=(0,n.useCallback)(()=>{if(!m.current)return;const e=m.current.innerHTML,t=m.current.innerText||"";y(!t.trim()),null===s||void 0===s||s(e),null===i||void 0===i||i(t),v()},[s,i,v]),j=(0,n.useCallback)(e=>{var t;switch(null===(t=m.current)||void 0===t||t.focus(),e){case"bold":document.execCommand("bold",!1);break;case"italic":document.execCommand("italic",!1);break;case"h1":document.execCommand("formatBlock",!1,"<h1>");break;case"h2":document.execCommand("formatBlock",!1,"<h2>");break;case"ul":document.execCommand("insertUnorderedList",!1);break;case"ol":document.execCommand("insertOrderedList",!1);break;case"blockquote":document.execCommand("formatBlock",!1,"<blockquote>")}b()},[b]),w=(0,n.useCallback)(e=>{if(e.ctrlKey||e.metaKey)switch(e.key.toLowerCase()){case"b":e.preventDefault(),j("bold");break;case"i":e.preventDefault(),j("italic")}},[j]);(0,n.useEffect)(()=>{const e=()=>{p&&v()};return document.addEventListener("selectionchange",e),()=>document.removeEventListener("selectionchange",e)},[p,v]);const N=(0,n.useCallback)(e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)},[]);return(0,l.jsxs)("div",{className:"relative",children:[d&&p&&(0,l.jsx)("div",{className:"sticky top-0 z-10 pb-3",children:(0,l.jsx)(G,{onFormat:j,activeFormats:h})}),(0,l.jsxs)("div",{className:"relative",children:[f&&!p&&(0,l.jsx)("div",{className:"absolute inset-0 pointer-events-none text-muted-foreground text-lg",children:a}),(0,l.jsx)("div",{ref:m,contentEditable:!0,suppressContentEditableWarning:!0,onInput:b,onKeyDown:w,onFocus:()=>g(!0),onBlur:()=>g(!1),onPaste:N,className:(0,o.cn)("outline-none text-lg leading-relaxed","prose prose-invert prose-lg max-w-none","prose-headings:font-semibold prose-headings:mb-4 prose-headings:mt-6","prose-h1:text-3xl prose-h2:text-2xl","prose-p:mb-4","prose-ul:mb-4 prose-ol:mb-4","prose-li:mb-1","prose-blockquote:border-l-4 prose-blockquote:border-primary prose-blockquote:pl-4 prose-blockquote:italic prose-blockquote:text-muted-foreground","caret-primary","[&:empty]:before:content-[attr(data-placeholder)] [&:empty]:before:text-muted-foreground","selection:bg-primary/30"),style:{minHeight:u},"data-placeholder":a}),(0,l.jsx)(r.P.div,{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary origin-left",initial:{scaleX:0},animate:{scaleX:p?1:0},transition:{duration:.2}})]})]})}function W(e){let{value:t,onChange:a,placeholder:r="Title"}=e;const s=(0,n.useRef)(null);return(0,l.jsx)("input",{ref:s,type:"text",value:t,onChange:e=>a(e.target.value),placeholder:r,className:(0,o.cn)("w-full bg-transparent outline-none","text-2xl font-semibold placeholder:text-muted-foreground","caret-primary")})}}}]);
//# sourceMappingURL=2461.7ef6875b.chunk.js.map
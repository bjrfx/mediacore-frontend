"use strict";(self.webpackChunkmediacore_frontend=self.webpackChunkmediacore_frontend||[]).push([[9562],{19562:(e,a,s)=>{s.r(a),s.d(a,{default:()=>P});var t=s(27051),l=s(65043),n=s(73216),o=s(81228),i=s(96938),r=s(65469),c=s(36210),d=s(75088),m=s(70067),x=s(28006),u=s(10629),h=s(48186),p=s(57922),f=s(9855),g=s(40614),j=s(99766),y=s(13390),N=s(17484),v=s(65598),b=s(82353),w=s(2461),A=s(62708),C=s(70579);const k=1e3,E=e=>new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"});function P(){var e,a,s;const{id:P}=(0,n.g)(),S=(0,n.Zp)(),{getEntry:D,createEntry:R,updateEntry:L,publishEntry:T,deleteEntry:z,addMedia:H,removeMedia:M,setLocation:O,currentDraft:V,setCurrentDraft:Z}=(0,A.A)(),[$,_]=(0,l.useState)(null),[U,I]=(0,l.useState)(!0),[G,Y]=(0,l.useState)(!1),[B,F]=(0,l.useState)(null),[J,q]=(0,l.useState)(!1),[Q,W]=(0,l.useState)(!1),[K,X]=(0,l.useState)(!1),[ee,ae]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if("new"===P){const e=R();_(e),Z(e)}else if(P){const e=D(P);if(!e)return void S("/journal",{replace:!0});_(e),Z(e)}I(!1)},[P,R,D,Z,S]);const se=(0,l.useMemo)(()=>(0,j.sg)((e,a)=>{L(e,a),F(new Date),Y(!1)},k),[L]),te=(0,l.useCallback)((e,a)=>{if(!$)return;Y(!0),_(s=>(0,t.A)((0,t.A)({},s),{},{[e]:a}));const s={[e]:a};se($.id,s)},[$,se]),le=(0,l.useCallback)(e=>{$&&(_(a=>(0,t.A)((0,t.A)({},a),{},{plainText:e})),se($.id,{plainText:e}))},[$,se]),ne=(0,l.useCallback)(e=>{te("mood",e)},[te]),oe=(0,l.useCallback)(async e=>{if($)try{await H($.id,e,"image");const a=D($.id);_(a)}catch(a){console.error("Error adding image:",a)}},[$,H,D]),ie=(0,l.useCallback)(async e=>{if(!$)return;await M($.id,e);const a=D($.id);_(a)},[$,M,D]),re=(0,l.useCallback)(async(e,a)=>{if($)try{await H($.id,e,"audio");const a=D($.id);_(a),W(!1)}catch(s){console.error("Error saving audio:",s)}},[$,H,D]),ce=(0,l.useCallback)(async e=>{if(!$)return;await M($.id,e);const a=D($.id);_(a)},[$,M,D]),de=(0,l.useCallback)(e=>{$&&(O($.id,e),_(a=>(0,t.A)((0,t.A)({},a),{},{location:e})))},[$,O]),me=(0,l.useCallback)(()=>{var e,a,s;$&&(null!==(e=$.title)&&void 0!==e&&e.trim()||null!==(a=$.plainText)&&void 0!==a&&a.trim()||null!==(s=$.media)&&void 0!==s&&s.length?(T($.id),S("/journal",{replace:!0})):alert("Please add some content to your entry"))},[$,T,S]),xe=(0,l.useCallback)(async()=>{$&&(await z($.id),ae(!1),S("/journal",{replace:!0}))},[$,z,S]),ue=(null===$||void 0===$||null===(e=$.media)||void 0===e?void 0:e.filter(e=>"image"===e.type))||[],he=(null===$||void 0===$||null===(a=$.media)||void 0===a?void 0:a.filter(e=>"audio"===e.type))||[],pe=null!==$&&void 0!==$&&$.mood?(0,w.IB)($.mood.value):null;return U||!$?(0,C.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,C.jsx)("div",{className:"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin"})}):(0,C.jsxs)(o.P.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen bg-background",children:[(0,C.jsx)("header",{className:"sticky top-0 z-20 bg-background/80 backdrop-blur-lg border-b border-border",children:(0,C.jsxs)("div",{className:"flex items-center justify-between px-4 h-14",children:[(0,C.jsxs)("div",{className:"flex items-center gap-2",children:[(0,C.jsx)(y.$,{variant:"ghost",size:"icon",onClick:()=>{var e,a,s;null===$||void 0===$||!$.isDraft||null!==(e=$.title)&&void 0!==e&&e.trim()||null!==(a=$.plainText)&&void 0!==a&&a.trim()||null!==(s=$.media)&&void 0!==s&&s.length||z($.id),S("/journal")},children:(0,C.jsx)(r.A,{className:"w-5 h-5"})}),(0,C.jsx)(i.N,{mode:"wait",children:G?(0,C.jsx)(o.P.span,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-xs text-muted-foreground",children:"Saving..."},"saving"):B?(0,C.jsxs)(o.P.span,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,C.jsx)(c.A,{className:"w-3 h-3 text-primary"}),"Saved"]},"saved"):null})]}),(0,C.jsxs)("div",{className:"flex items-center gap-2",children:[(0,C.jsx)(y.$,{variant:"default",size:"sm",onClick:me,className:"rounded-full",children:$.isDraft?"Save Entry":"Update"}),(0,C.jsxs)(N.rI,{children:[(0,C.jsx)(N.ty,{asChild:!0,children:(0,C.jsx)(y.$,{variant:"ghost",size:"icon",children:(0,C.jsx)(h.A,{className:"w-5 h-5"})})}),(0,C.jsxs)(N.SQ,{align:"end",children:[(0,C.jsxs)(N._2,{onClick:()=>q(!0),children:[(0,C.jsx)(p.A,{className:"w-4 h-4 mr-2"}),$.mood?"Edit Mood":"Add Mood"]}),(0,C.jsxs)(N._2,{onClick:()=>W(!0),children:[(0,C.jsx)(u.A,{className:"w-4 h-4 mr-2"}),"Record Audio"]}),(0,C.jsxs)(N._2,{onClick:()=>X(!0),children:[(0,C.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Add Photos"]}),(0,C.jsx)(N.mB,{}),(0,C.jsxs)(N._2,{onClick:()=>ae(!0),className:"text-destructive",children:[(0,C.jsx)(f.A,{className:"w-4 h-4 mr-2"}),"Delete Entry"]})]})]})]})]})}),(0,C.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-6 space-y-6 pb-24",children:[(0,C.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,C.jsx)(d.A,{className:"w-4 h-4"}),(0,C.jsx)("span",{children:E($.createdAt)})]}),pe&&(0,C.jsxs)(o.P.button,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},onClick:()=>q(!0),className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-secondary/50 hover:bg-secondary transition-colors",children:[(0,C.jsx)("span",{className:"text-lg",children:pe.emoji}),(0,C.jsx)("span",{className:"text-sm font-medium",children:pe.label}),(null===(s=$.mood.emotions)||void 0===s?void 0:s.length)>0&&(0,C.jsxs)("span",{className:"text-xs text-muted-foreground",children:["\u2022 ",$.mood.emotions.slice(0,2).join(", "),$.mood.emotions.length>2&&" +".concat($.mood.emotions.length-2)]})]}),$.location&&(0,C.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,C.jsx)(x.A,{className:"w-4 h-4"}),(0,C.jsx)("span",{children:$.location.name})]}),(0,C.jsx)(w.t3,{value:$.title||"",onChange:e=>te("title",e),placeholder:"Title (optional)"}),(0,C.jsx)(w.dS,{content:$.content||"",placeholder:"What's on your mind?",onChange:e=>te("content",e),onPlainTextChange:le,autoFocus:"new"===P,minHeight:"300px"}),he.length>0&&(0,C.jsxs)("div",{className:"space-y-3",children:[(0,C.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"Voice Recordings"}),he.map(e=>(0,C.jsxs)("div",{className:"relative group",children:[(0,C.jsx)(w.Y$,{audioUrl:e.url,duration:e.duration,name:e.name}),(0,C.jsx)("button",{onClick:()=>ce(e.id),className:"absolute -top-2 -right-2 w-6 h-6 rounded-full bg-destructive flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,C.jsx)(g.A,{className:"w-3 h-3 text-white"})})]},e.id))]}),ue.length>0&&(0,C.jsxs)("div",{className:"space-y-3",children:[(0,C.jsx)("h4",{className:"text-sm font-medium text-muted-foreground",children:"Photos"}),(0,C.jsx)("div",{className:"grid grid-cols-3 gap-2",children:ue.map((e,a)=>(0,C.jsxs)(o.P.div,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"relative aspect-square rounded-xl overflow-hidden group",children:[(0,C.jsx)("img",{src:e.url,alt:"Photo ".concat(a+1),className:"w-full h-full object-cover"}),(0,C.jsx)("button",{onClick:()=>ie(e.id),className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,C.jsx)(g.A,{className:"w-3 h-3 text-white"})})]},e.id))})]})]}),(0,C.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-lg border-t border-border p-4",children:(0,C.jsxs)("div",{className:"max-w-2xl mx-auto flex items-center justify-center gap-2",children:[(0,C.jsxs)(o.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>q(!0),className:(0,j.cn)("flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-colors",$.mood?"bg-primary/10 text-primary":"bg-secondary/50 text-muted-foreground hover:text-foreground hover:bg-secondary"),children:[(0,C.jsx)(p.A,{className:"w-4 h-4"}),"Mood"]}),(0,C.jsxs)(o.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>W(!0),className:"flex items-center gap-2 px-4 py-2 rounded-full bg-secondary/50 text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors",children:[(0,C.jsx)(u.A,{className:"w-4 h-4"}),"Voice"]}),(0,C.jsxs)(o.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>X(!0),className:"flex items-center gap-2 px-4 py-2 rounded-full bg-secondary/50 text-sm font-medium text-muted-foreground hover:text-foreground hover:bg-secondary transition-colors",children:[(0,C.jsx)(m.A,{className:"w-4 h-4"}),"Photo"]})]})}),(0,C.jsx)(v.lG,{open:J,onOpenChange:q,children:(0,C.jsxs)(v.Cf,{className:"sm:max-w-lg",children:[(0,C.jsx)(v.c7,{children:(0,C.jsx)(v.L3,{children:"How are you feeling?"})}),(0,C.jsx)(w.Vd,{mood:$.mood,onChange:e=>{ne(e),q(!1)}})]})}),(0,C.jsx)(v.lG,{open:Q,onOpenChange:W,children:(0,C.jsxs)(v.Cf,{className:"sm:max-w-md",children:[(0,C.jsx)(v.c7,{children:(0,C.jsx)(v.L3,{children:"Record Voice Note"})}),(0,C.jsx)(w.Nr,{onSave:re,onCancel:()=>W(!1)})]})}),(0,C.jsx)(v.lG,{open:K,onOpenChange:X,children:(0,C.jsxs)(v.Cf,{className:"sm:max-w-lg",children:[(0,C.jsx)(v.c7,{children:(0,C.jsx)(v.L3,{children:"Add Photos & Location"})}),(0,C.jsx)(w.Px,{images:ue,location:$.location,onAddImage:oe,onRemoveImage:ie,onLocationChange:de})]})}),(0,C.jsx)(b.Lt,{open:ee,onOpenChange:ae,children:(0,C.jsxs)(b.EO,{children:[(0,C.jsxs)(b.wd,{children:[(0,C.jsx)(b.r7,{children:"Delete Entry?"}),(0,C.jsx)(b.$v,{children:"This action cannot be undone. This will permanently delete your journal entry and all its attachments."})]}),(0,C.jsxs)(b.ck,{children:[(0,C.jsx)(b.Zr,{children:"Cancel"}),(0,C.jsx)(b.Rx,{onClick:xe,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})}},82353:(e,a,s)=>{s.d(a,{$v:()=>C,EO:()=>v,Lt:()=>j,Rx:()=>k,Zr:()=>E,ck:()=>w,r7:()=>A,wd:()=>b});var t=s(27051),l=s(53986),n=s(65043),o=s(74796),i=s(99766),r=s(13390),c=s(70579);const d=["className"],m=["className"],x=["className"],u=["className"],h=["className"],p=["className"],f=["className"],g=["className"],j=o.bL,y=(o.l9,o.ZL),N=n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,d);return(0,c.jsx)(o.hJ,(0,t.A)((0,t.A)({className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},n),{},{ref:a}))});N.displayName=o.hJ.displayName;const v=n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,m);return(0,c.jsxs)(y,{children:[(0,c.jsx)(N,{}),(0,c.jsx)(o.UC,(0,t.A)({ref:a,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},n))]})});v.displayName=o.UC.displayName;const b=e=>{let{className:a}=e,s=(0,l.A)(e,x);return(0,c.jsx)("div",(0,t.A)({className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",a)},s))};b.displayName="AlertDialogHeader";const w=e=>{let{className:a}=e,s=(0,l.A)(e,u);return(0,c.jsx)("div",(0,t.A)({className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a)},s))};w.displayName="AlertDialogFooter";const A=n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,h);return(0,c.jsx)(o.hE,(0,t.A)({ref:a,className:(0,i.cn)("text-lg font-semibold",s)},n))});A.displayName=o.hE.displayName;const C=n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,p);return(0,c.jsx)(o.VY,(0,t.A)({ref:a,className:(0,i.cn)("text-sm text-muted-foreground",s)},n))});C.displayName=o.VY.displayName;const k=n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,f);return(0,c.jsx)(o.rc,(0,t.A)({ref:a,className:(0,i.cn)((0,r.r)(),s)},n))});k.displayName=o.rc.displayName;const E=n.forwardRef((e,a)=>{let{className:s}=e,n=(0,l.A)(e,g);return(0,c.jsx)(o.ZD,(0,t.A)({ref:a,className:(0,i.cn)((0,r.r)({variant:"outline"}),"mt-2 sm:mt-0",s)},n))});E.displayName=o.ZD.displayName}}]);
//# sourceMappingURL=9562.36a3170d.chunk.js.map